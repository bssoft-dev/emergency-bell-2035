<div class="content-wrapper">
    <div class="row">
        <div class="card">

            <div class="table-responsive">
                <div class="devicetitle">
                    <div class="pt-1">
                        <button class="btn abtn" (click)="clickedModal()">
              <i class="menu-icon mdi mdi-plus"></i>
              회원 등록
            </button>
                    </div>
                </div>
                <table class="table table-dark table-striped">
                    <thead>
                        <tr class="tabletr">
                            <th class="tableth">
                                아이디
                            </th>
                            <th class="tableth">
                                고객사명
                            </th>
                            <th class="tableth">
                                담당자명
                            </th>
                            <th class="tableth">
                                연락처
                            </th>
                            <th class="tableth">
                                이메일
                            </th>
                            <th class="tableth">
                                등록일자
                            </th>
                            <th class="tableth">
                                관리자권한
                            </th>
                            <th class="tableth modifyth">
                                변경
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let i of getallusersdata[0];let index = index">
                            <td class="tabletd font-weight-medium">
                                {{i.username}}
                            </td>
                            <td class="tabletd">
                                {{i.customerName}}
                            </td>
                            <td class="tabletd">
                                {{i.name}}
                            </td>
                            <td class="tabletd">
                                {{i.phone}}
                            </td>
                            <td class="tabletd">
                                {{i.email}}
                            </td>
                            <td class="tabletd">
                                {{i.createTime}}
                            </td>

                            <td class="tabletd">
                                <input class="toggleinput" [checked]="i.is_superuser" type="checkbox" id="{{index}}" (click)="modifymanager(index)" />
                                <label class="togglelabel abtn" for="{{index}}"></label>
                            </td>

                            <td class="tabletd">
                                <ul class="modify">
                                    <li>
                                        <button class="modifying abtn">
                      <i class="menu-icon mdi mdi-pencil-box-outline" (click)="getOneUser(index)"></i>
                    </button>
                                    </li>
                                    <li>
                                        <button class="modifying abtn">
                      <i class="menu-icon mdi mdi-delete" (click)="deleteoneUser(index)"></i>
                    </button>
                                    </li>
                                </ul>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

        </div>

    </div>
</div>

<div [ngClass]="modal ? 'modal fade show d-block' : 'modal fade' " tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" class="modalcontainer">
    <div class="modal-dialog" role="document">

        <div class="modal-content">
            <div class="deviceenrollcard">
                <h5 class="modal-title" id="exampleModalLabel">회원등록</h5>

                <form [formGroup]="registeruserForm" (ngSubmit)="registerUser()" novalidate>

                    <div class="inputDiv">
                        <p class="inputtitle">[아이디]</p>
                        <div class="sectiondiv">
                            <input placeholder="(필수) 아이디를 입력해주세요" (focus)="usernamechange($event)" [ngClass]="(registeruserForm.controls.username.valid || !registeruserForm.controls.username.touched) ? 'enrolldevice' : 'nonenrolldevice'" type="text" formControlName="username" />
                            <button (click)="duplicatecheck()" type="button" [ngClass]="registeruserForm.controls.username.valid ? 'duplicatebutton abtn' : 'nonduplicatebutton' " [disabled]="registeruserForm.hasError('pattern','username') || registeruserForm.hasError('required', 'username')">중복확인</button>
                        </div>
                    </div>
                    <div class="confirmidbox" [hidden]="!overlapcheck">
                        <p>회원가입이 가능한 아이디 입니다.</p>
                    </div>

                    <div class="inputDiv">
                        <p class="inputtitle">[이름]</p>
                        <input placeholder="이름을 입력해주세요" class="enrolldevice" type="text" formControlName="name" />
                    </div>

                    <div class="inputDiv">
                        <p class="inputtitle">[고객사명]</p>
                        <select ng-model="selected" formControlName="customerName">
              <option [ngValue]="null">고객사명을 선택해 주세요</option>
              <option *ngFor="let i of customerNames" value="{{i}}">{{i}}</option>
              <!-- <input placeholder="고객사명을 입력해주세요" class="enrolldevice" type="text" formControlName="customerName" /> -->
            </select>
                    </div>

                    <div class="inputDiv">
                        <p class="inputtitle">[연락처]</p>
                        <input placeholder="연락처를 입력해주세요" class="enrolldevice" type="text" formControlName="phone" />
                    </div>

                    <div class="inputDiv">
                        <p class="inputtitle">[이메일]</p>
                        <input placeholder="이메일을 입력해주세요 (비밀번호 분실시 이용됩니다)" class="enrolldevice" type="text" formControlName="email" />
                    </div>

                    <div formGroupName="passwordGroup">
                        <div class="inputDiv">
                            <p class="inputtitle">[패스워드]</p>
                            <input placeholder="(필수) 패스워드를 입력해주세요" [ngClass]="(registeruserForm.controls.passwordGroup.valid || !registeruserForm.controls.passwordGroup.touched) ? 'enrolldevice' : 'nonenrolldevice'" type="password" formControlName="password" autocomplete="off" />
                        </div>

                        <div class="inputDiv">
                            <p class="inputtitle">[패스워드확인]</p>
                            <input placeholder="(필수) 패스워드를 입력해주세요" [ngClass]="(registeruserForm.controls.passwordGroup.valid || !registeruserForm.controls.passwordGroup.touched) ? 'enrolldevice' : 'nonenrolldevice'" type="password" formControlName="passwordconfirm" autocomplete="off"
                            />
                        </div>

                        <div class="confirmpasswordbox" *ngIf="registeruserForm.controls.passwordGroup.touched" [hidden]="!registeruserForm.hasError('required',['passwordGroup','password']) ">
                            <p>패스워드를 입력해주세요</p>
                        </div>
                        <div class="confirmpasswordbox" [hidden]="!registeruserForm.hasError('equal','passwordGroup')">
                            <p>패스워드가 다릅니다</p>
                        </div>
                    </div>

                    <div class="modal_footer">
                        <button class="footerbutton abtn" tabindex="10" type="button" (click)="clickedModalClose()">취소</button>
                        <button [ngClass]="!registeruserForm.valid || !overlapcheck ? 'nonactivebutton' : 'footerbutton abtn' " tabindex="11" type="submit" [disabled]="!registeruserForm.valid">회원등록</button>
                    </div>
                </form>


            </div>
        </div>
    </div>
</div>

<div [ngClass]="modal2 ? 'modal fade show d-block' : 'modal fade' " tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" class="modalcontainer">
    <div class="modal-dialog" role="document">

        <div class="modal-content">
            <div class="deviceenrollcard">
                <h5 class="modal-title" id="exampleModalLabel">회원수정</h5>

                <form [formGroup]="modifyuserForm" (ngSubmit)="modifyoneUser()" novalidate>

                    <div class="inputDiv">
                        <p class="inputtitle">[아이디]</p>
                        <input placeholder="(필수) 아이디를 입력해 주세요" class="enrolldevice" type="text" formControlName="username" />
                    </div>

                    <div class="inputDiv">
                        <p class="inputtitle">[이름]</p>
                        <input placeholder="(필수) 이름을 입력해 주세요" class="enrolldevice" type="text" formControlName="name" />
                    </div>

                    <div class="inputDiv">
                        <p class="inputtitle">[연락처]</p>
                        <input placeholder="연락처를 입력해 주세요" class="enrolldevice" type="text" formControlName="phone" />
                    </div>

                    <div class="inputDiv">
                        <p class="inputtitle">[이메일]</p>
                        <input placeholder="이메일을 입력해 주세요 (비밀번호 분실시 이용됩니다)" class="enrolldevice" type="text" formControlName="email" />
                    </div>

                    <div formGroupName="passwordGroup">
                        <div class="inputDiv">
                            <p class="inputtitle">[패스워드]</p>
                            <input placeholder="(필수) 패스워드를 입력해 주세요" class="enrolldevice" type="password" formControlName="password" autocomplete="off" />
                        </div>

                        <div class="inputDiv">
                            <p class="inputtitle">[패스워드확인]</p>
                            <input placeholder="(필수) 패스워드를 입력해 주세요" class="enrolldevice" type="password" formControlName="passwordconfirm" autocomplete="off" />
                        </div>

                        <div class="confirmpasswordbox" [hidden]="!modifyuserForm.hasError('equal','passwordGroup')">
                            <p>패스워드가 다릅니다</p>
                        </div>
                    </div>

                    <div class="modal_footer">
                        <button class="footerbutton" tabindex="10" type="button" (click)="clickedModal2Close()">취소</button>
                        <button [ngClass]="!modifyuserForm.valid ? 'nonactivebutton' : 'footerbutton' " tabindex="11" type="submit" [disabled]="!modifyuserForm.valid ">회원수정</button>
                    </div>

                    <div class="confirmpasswordbox" [hidden]="!modifyuserForm.hasError('required',['passwordGroup','password']) && !modifyuserForm.hasError('required',['passwordGroup','passwordconfirm']) ">
                        <p>패스워드를 입력해주세요</p>
                    </div>
                </form>


            </div>
        </div>
    </div>
</div>